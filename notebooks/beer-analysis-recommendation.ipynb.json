{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Test Project: Beer Reviews Analysis and Recommendation\n",
    "\n",
    "Data: 1.5M beer reviews from beer advocate. (https://s3.amazonaws.com/demo-datasets/beer_reviews.tar.gz)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Import packages Numpy, Scikit Learn and Pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import sklearn\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Read in the \"csv\" file with reviews into a pandas \"data frame\". Pandas has this nice reader that can read a bunch of file formats and store the data in a \"data frame\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "beer_data = pd.read_csv('/Users/phani/Downloads/beer_reviews/beer_reviews.csv', delimiter=\",\", encoding='utf-8')\n",
    "# download the revievs csv form the link above. Alternatively, use 'urlopen' and rebuild this command \n",
    "#to read the csv file after unzipping the response "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Column 0 :  brewery_id\n",
      "Column 1 :  brewery_name\n",
      "Column 2 :  review_time\n",
      "Column 3 :  review_overall\n",
      "Column 4 :  review_aroma\n",
      "Column 5 :  review_appearance\n",
      "Column 6 :  review_profilename\n",
      "Column 7 :  beer_style\n",
      "Column 8 :  review_palate\n",
      "Column 9 :  review_taste\n",
      "Column 10 :  beer_name\n",
      "Column 11 :  beer_abv\n",
      "Column 12 :  beer_beerid\n"
     ]
    }
   ],
   "source": [
    "for i in range(len(beer_data.columns)):\n",
    "    print(\"Column\",i, \": \", beer_data.columns[i])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "####  Q1.Which brewery produces the strongest beers by ABV% - simple idea is to rank breweries based on the abv% of the beers produced by them.\n",
    "\n",
    "The data in the csv file has some undefined (\"NaN\") values for abv%. More than one users have rated the beers (duplicate abv% values). For sorting and ranking, these things don't matter. This can be accomplished in two steps\n",
    "- make a copy\n",
    "- sort the data in \"beer_abv\" column in descending order\n",
    "- pick the brewery that produces beer with highest abv%."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Brewery Name:  Schorschbräu\n",
      "Beer Name:  Schorschbräu Schorschbock 57%\n",
      "Beer ABV%:  57.7\n",
      "Beer ID:  73368\n"
     ]
    }
   ],
   "source": [
    "beer_data_abv = beer_data.copy()\n",
    "beer_data_abv_sorted = beer_data_abv.sort_values(by=\"beer_abv\", ascending=False)\n",
    "print (\"Brewery Name: \", beer_data_abv_sorted.loc[beer_data_abv_sorted[\"beer_abv\"].keys()[0]].brewery_name)\n",
    "print (\"Beer Name: \", beer_data_abv_sorted.loc[beer_data_abv_sorted[\"beer_abv\"].keys()[0]].beer_name)\n",
    "print (\"Beer ABV%: \", beer_data_abv_sorted.loc[beer_data_abv_sorted[\"beer_abv\"].keys()[0]].beer_abv)\n",
    "print (\"Beer ID: \", beer_data_abv_sorted.loc[beer_data_abv_sorted[\"beer_abv\"].keys()[0]].beer_beerid)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\nmjJzYmXbOOAmYK/MfLDDsf8FtGfm1C7GsUdDklRVLS0tzJ59EVddtZy2thE0Nm5kypSjOe+8M7fb\noPrMM7BqFSxdCueddxxPPtn9aqUjRhzPW9/as9VKr7122yuf7rff8ZXVWrdv8zoh//M/S7j//l/A\nEF0Z9MvAq4CjqzHYjBkz2HXXXbfaNnXqVKZOfU42kSRpm5qamli4cC4LF/a+6XKHHeCww+DQQ5NL\nLhnJunXdr1b6zDMj2LBh++Nnbn/l0z/+cQT7758ceGBw4IHFnXYPOKD4d//94YorFrN48WKefvpp\nbrrpF7S0HADs3OPvqyfqJmhExL8BbwWOycz7O+x6gOJVfCnwYIftLwVu29aYCxYscEZDklR1fW1Q\n7ckKqi97WStLl1Zn5dPdd2/l7W8Pfv97WL68uAHexo1bjth776kccMBUHn54Do8/Ph2YBKwCxvb6\ne+tOXfRoVELGicAbM/NPHfdl5hqKsHFsh+N3obhK5ecDWackSf01kCufnnLKeM4/Hy6/vOgbefxx\nuP9+uPFG+PrX4f3vL66Sueee5WR2vU5If5XeoxERXwamAlOAjmtnrM/MTZVjPgmcDbwPWAucC7wa\neHVmPtXFmPZoSJLq0ublzFevntGhiTNpaLiO5uYFvVqUrBpj5XPWCXl2RmPIrKPxEYrLVX9KcRnr\n5sc7Nh+QmedTrLVxKcXVJs8H3tJVyJAkqZ6VufJpV7a/Tkj/lD6jUQvOaEiSBoveNpbWYqzp0+ew\naNG4yqzI0JvRkCRp2Cp75VPobp2Q6jBoSJI0zHU8BfOyl32sqmMbNCRJ0rPrhFxzzVeqOq5BQ5Ik\n1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxB\nQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik\n1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxB\nQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1YxBQ5Ik1UxdBI2IOCYiroqI\ndRHRHhFTujjmnIi4LyI2RsSyiDiwjFolSVLP1UXQAEYCvwI+BmTnnRFxNjAN+BBwONAKLI2InQay\nSEmS1Ds7ll0AQGZeB1wHEBHRxSGnA+dm5jWVY94DPAicBHxvoOqUJEm9Uy8zGt2KiNHAnsCPN2/L\nzA3ACmBcWXVJkqTtq/ugQREykmIGo6MHK/skSVKdGgxBQ5IkDVJ10aOxHQ8AAbyUrWc1Xgrctq0n\nzpgxg1133XWrbVOnTmXq1KnVrlGSpEFn8eLFLF68eKtt69evr+rXiMznXORRqohoB07KzKs6bLsP\nuCAzF1Q+34UidLwnM/+7izHGACtXrlzJmDFjBqhySZIGv1WrVjF27FiAsZm5qr/j1cWMRkSMBA6k\nmLkA2D8iXg88mpl/Bi4GZkfEPcBa4FzgXuDKEsqVJEk9VBdBAzgU+AlF02cCF1W2fwM4NTPPj4gR\nwKXAbsCNwFsy86kyipUkST1TF0EjM3/GdhpTM3MuMHcg6pEkSdXhVSeSJKlmDBqSJKlmDBqSJKlm\nDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqS\nJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlm\nDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqS\nJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqSJKlmDBqqmsWL\nF5ddwrDjaz7wfM0Hnq/54DaogkZEfDwi1kTEExFxS0QcVnZN2sIfBgPP13zg+ZoPPF/zwW3QBI2I\n+EfgImAO8DfA7cDSiNij1MIkSVK3Bk3QAGYAl2bmNzPzN8BHgI3AqeWWJUmSujMogkZENAJjgR9v\n3paZCfwIGFdWXZIkadt2LLuAHtoD2AF4sNP2B4GDuzh+Z4DVq1fXuCx1tH79elatWlV2GcOKr/nA\n8zUfeL7mA6vD786dqzFeFBMD9S0iXgasA8Zl5ooO278ATMjMcZ2OfyfwnYGtUpKkIeWUzLysv4MM\nlhmNh4FngJd22v5S4IEujl8KnAKsBTbVtDJJkoaWnYFRFL9L+21QzGgARMQtwIrMPL3yeQB/Ar6Y\nmReUWpwkSerSYJnRAJgPfD0iVgK3UlyFMgL4eplFSZKk7g2aoJGZ36usmXEOxSmTXwEnZOZD5VYm\n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\nzP8PGoLAgG6MbYAAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x1194fd240>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "from matplotlib.pyplot import axes\n",
    "beer_data_abv_sorted = beer_data_abv_sorted.drop_duplicates(\"beer_beerid\")\n",
    "\n",
    "plt.plot(beer_data_abv_sorted[\"beer_abv\"].get_values(), linestyle=None, marker='o')\n",
    "plt.xlabel(\"beer_Index\")\n",
    "plt.ylabel(\"ABV%\")\n",
    "#plt.annotate()\n",
    "plt.axis([-5, 20, 0, 60]) # plotting first 20 beers\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Q2. Recommend beers based on the data - Build a content-based recommendation system\n",
    "\n",
    "Data Matrix: Lets assume that ratings are correct and correlate with user preferences. Data matrix contains overall reviews and users data. We collect user info based on review_profilename. Hence, some data points with missing \"review_profilename\" are dropped from the data matrix. \n",
    "\n",
    "Features Matrix: Features matrix contains five features - four features (aroma, palette, appearance, taste) reated by different users and beer alcohol value (ABV%). We assume that the rating is proportional to their tastes.\n",
    "\n",
    "Here we use linear regression with regularization to calculate the parameters that correlate features with overall rating. \n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "collapsed": false,
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "32908\n",
      "49000\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>beer_beerid</th>\n",
       "      <th>review_overall</th>\n",
       "      <th>review_taste</th>\n",
       "      <th>review_aroma</th>\n",
       "      <th>review_palate</th>\n",
       "      <th>review_appearance</th>\n",
       "      <th>beer_abv</th>\n",
       "      <th>review_profilename</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>47986</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>stcules</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>48213</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.2</td>\n",
       "      <td>stcules</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>48215</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.5</td>\n",
       "      <td>stcules</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>47969</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>stcules</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>64883</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.7</td>\n",
       "      <td>johnmichaelsen</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>52159</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.7</td>\n",
       "      <td>oline73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>52159</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.7</td>\n",
       "      <td>Reidrover</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>52159</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.7</td>\n",
       "      <td>alpinebryant</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>52159</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.7</td>\n",
       "      <td>LordAdmNelson</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>52159</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.7</td>\n",
       "      <td>augustgarage</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>436</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>fodeeoz</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>52159</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.7</td>\n",
       "      <td>MadeInOregon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>52159</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.7</td>\n",
       "      <td>rawthar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>52159</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.7</td>\n",
       "      <td>Halcyondays</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>52159</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.7</td>\n",
       "      <td>RangerClegg</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>10789</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>7.2</td>\n",
       "      <td>Beerandraiderfan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>10789</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>7.2</td>\n",
       "      <td>RedDiamond</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>12386</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.6</td>\n",
       "      <td>beerguy101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>436</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>jdhilt</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>UCLABrewN84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>zaphodchak</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>Tilley4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>7.4</td>\n",
       "      <td>mikedrinksbeer2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>dbmernin83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>titosupertramp</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>58046</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>7.4</td>\n",
       "      <td>optimator13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>Blakaeris</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>bashiba</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>7.4</td>\n",
       "      <td>Klym</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>58046</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.4</td>\n",
       "      <td>flexabull</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586580</th>\n",
       "      <td>36388</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>EPseja</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586581</th>\n",
       "      <td>36388</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>EPseja</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586582</th>\n",
       "      <td>36388</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.5</td>\n",
       "      <td>maddogruss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586583</th>\n",
       "      <td>34215</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.8</td>\n",
       "      <td>TongoRad</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586584</th>\n",
       "      <td>34215</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.8</td>\n",
       "      <td>dherling</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586585</th>\n",
       "      <td>34215</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>5.8</td>\n",
       "      <td>tgbljb</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586586</th>\n",
       "      <td>34215</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>5.8</td>\n",
       "      <td>cbl2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586588</th>\n",
       "      <td>62147</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>Buddha22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586589</th>\n",
       "      <td>62147</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>8.0</td>\n",
       "      <td>JohnQVegas</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586590</th>\n",
       "      <td>62147</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>cpanossian</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586591</th>\n",
       "      <td>62147</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>claspada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586592</th>\n",
       "      <td>41749</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>RblWthACoz</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586593</th>\n",
       "      <td>41749</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>yelterdow</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586594</th>\n",
       "      <td>38160</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>maddogruss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586595</th>\n",
       "      <td>71234</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>JerzDevl2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586599</th>\n",
       "      <td>43233</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>Lenny2884</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586600</th>\n",
       "      <td>33061</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>ummswimmin</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586601</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>pzrhsau</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586602</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>asabreed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586603</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>infi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586604</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>njmoons</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586605</th>\n",
       "      <td>33061</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>NyackNicky</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586606</th>\n",
       "      <td>33061</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>blitheringidiot</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586607</th>\n",
       "      <td>33061</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>PopeDX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586608</th>\n",
       "      <td>33061</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>treehugger02010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586609</th>\n",
       "      <td>33061</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>maddogruss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586610</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>yelterdow</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586611</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.5</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>TongoRad</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586612</th>\n",
       "      <td>33061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>dherling</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1586613</th>\n",
       "      <td>33061</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>4.5</td>\n",
       "      <td>5.2</td>\n",
       "      <td>cbl2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1518478 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         beer_beerid  review_overall  review_taste  review_aroma  \\\n",
       "0              47986             1.5           1.5           2.0   \n",
       "1              48213             3.0           3.0           2.5   \n",
       "2              48215             3.0           3.0           2.5   \n",
       "3              47969             3.0           3.0           3.0   \n",
       "4              64883             4.0           4.5           4.5   \n",
       "5              52159             3.0           3.5           3.5   \n",
       "6              52159             3.5           4.0           3.5   \n",
       "7              52159             3.0           3.5           2.5   \n",
       "8              52159             4.0           4.0           3.0   \n",
       "9              52159             4.5           4.0           3.5   \n",
       "10               436             3.0           2.5           2.0   \n",
       "11             52159             5.0           4.0           5.0   \n",
       "12             52159             4.0           4.0           4.0   \n",
       "13             52159             4.0           3.0           4.5   \n",
       "14             52159             3.5           4.0           4.0   \n",
       "15             10789             3.0           3.0           3.0   \n",
       "16             10789             2.0           2.0           1.5   \n",
       "17             12386             4.0           4.0           3.0   \n",
       "18               436             2.5           2.0           3.0   \n",
       "19             58046             4.5           4.5           4.5   \n",
       "20             58046             4.0           4.0           4.0   \n",
       "21             58046             4.0           4.0           4.5   \n",
       "22             58046             4.5           4.5           5.0   \n",
       "23             58046             4.0           4.5           4.5   \n",
       "24             58046             4.5           4.5           4.5   \n",
       "25             58046             5.0           5.0           5.0   \n",
       "26             58046             4.5           4.5           4.5   \n",
       "27             58046             4.5           4.0           5.0   \n",
       "28             58046             4.5           4.5           4.5   \n",
       "29             58046             4.5           4.0           4.5   \n",
       "...              ...             ...           ...           ...   \n",
       "1586580        36388             5.0           4.5           4.5   \n",
       "1586581        36388             5.0           4.5           4.5   \n",
       "1586582        36388             4.0           3.5           4.0   \n",
       "1586583        34215             4.5           4.5           4.0   \n",
       "1586584        34215             4.5           4.0           4.0   \n",
       "1586585        34215             3.5           3.5           3.5   \n",
       "1586586        34215             3.5           3.5           3.5   \n",
       "1586588        62147             2.0           2.5           2.5   \n",
       "1586589        62147             1.0           1.0           4.0   \n",
       "1586590        62147             1.5           1.5           3.5   \n",
       "1586591        62147             1.0           1.0           2.0   \n",
       "1586592        41749             4.5           4.5           3.5   \n",
       "1586593        41749             4.5           4.0           4.0   \n",
       "1586594        38160             3.0           4.0           3.5   \n",
       "1586595        71234             4.0           4.0           3.5   \n",
       "1586599        43233             3.5           4.0           4.5   \n",
       "1586600        33061             3.5           3.5           4.0   \n",
       "1586601        33061             4.5           4.0           4.0   \n",
       "1586602        33061             4.0           4.0           4.0   \n",
       "1586603        33061             4.0           4.0           4.5   \n",
       "1586604        33061             4.0           3.5           4.5   \n",
       "1586605        33061             5.0           5.0           5.0   \n",
       "1586606        33061             5.0           5.0           4.5   \n",
       "1586607        33061             5.0           4.5           5.0   \n",
       "1586608        33061             3.5           3.0           4.0   \n",
       "1586609        33061             5.0           4.0           4.0   \n",
       "1586610        33061             4.0           4.0           5.0   \n",
       "1586611        33061             4.5           4.0           3.5   \n",
       "1586612        33061             4.0           4.5           4.5   \n",
       "1586613        33061             5.0           4.5           4.5   \n",
       "\n",
       "         review_palate  review_appearance  beer_abv review_profilename  \n",
       "0                  1.5                2.5       5.0            stcules  \n",
       "1                  3.0                3.0       6.2            stcules  \n",
       "2                  3.0                3.0       6.5            stcules  \n",
       "3                  2.5                3.5       5.0            stcules  \n",
       "4                  4.0                4.0       7.7     johnmichaelsen  \n",
       "5                  3.0                3.5       4.7            oline73  \n",
       "6                  4.0                3.5       4.7          Reidrover  \n",
       "7                  2.0                3.5       4.7       alpinebryant  \n",
       "8                  3.5                3.5       4.7      LordAdmNelson  \n",
       "9                  4.0                5.0       4.7       augustgarage  \n",
       "10                 2.5                3.0       3.5            fodeeoz  \n",
       "11                 4.0                4.0       4.7       MadeInOregon  \n",
       "12                 3.5                4.0       4.7            rawthar  \n",
       "13                 2.5                3.0       4.7        Halcyondays  \n",
       "14                 3.0                3.0       4.7        RangerClegg  \n",
       "15                 3.0                2.5       7.2   Beerandraiderfan  \n",
       "16                 2.5                2.5       7.2         RedDiamond  \n",
       "17                 4.0                4.0       5.6         beerguy101  \n",
       "18                 2.0                3.0       3.5             jdhilt  \n",
       "19                 4.0                3.0       7.4        UCLABrewN84  \n",
       "20                 3.0                4.0       7.4         zaphodchak  \n",
       "21                 3.5                4.0       7.4            Tilley4  \n",
       "22                 4.0                4.5       7.4    mikedrinksbeer2  \n",
       "23                 4.0                4.0       7.4         dbmernin83  \n",
       "24                 4.0                4.0       7.4     titosupertramp  \n",
       "25                 3.5                3.5       7.4        optimator13  \n",
       "26                 4.0                4.0       7.4          Blakaeris  \n",
       "27                 4.0                4.0       7.4            bashiba  \n",
       "28                 4.0                3.5       7.4               Klym  \n",
       "29                 4.0                4.0       7.4          flexabull  \n",
       "...                ...                ...       ...                ...  \n",
       "1586580            4.5                4.5       5.5             EPseja  \n",
       "1586581            4.5                4.5       5.5             EPseja  \n",
       "1586582            3.5                4.0       5.5         maddogruss  \n",
       "1586583            4.0                3.0       5.8           TongoRad  \n",
       "1586584            4.0                4.0       5.8           dherling  \n",
       "1586585            3.5                3.5       5.8             tgbljb  \n",
       "1586586            3.5                3.5       5.8               cbl2  \n",
       "1586588            2.0                3.0       8.0           Buddha22  \n",
       "1586589            3.0                4.5       8.0         JohnQVegas  \n",
       "1586590            3.0                4.0       8.0         cpanossian  \n",
       "1586591            2.0                3.0       8.0           claspada  \n",
       "1586592            4.0                4.0       5.2         RblWthACoz  \n",
       "1586593            4.0                4.5       5.2          yelterdow  \n",
       "1586594            4.0                4.0       6.0         maddogruss  \n",
       "1586595            4.0                4.0       5.0       JerzDevl2000  \n",
       "1586599            4.0                4.0       9.0          Lenny2884  \n",
       "1586600            3.0                3.5       5.2         ummswimmin  \n",
       "1586601            4.5                4.0       5.2            pzrhsau  \n",
       "1586602            4.0                4.0       5.2           asabreed  \n",
       "1586603            4.0                4.0       5.2               infi  \n",
       "1586604            3.5                4.5       5.2            njmoons  \n",
       "1586605            5.0                5.0       5.2         NyackNicky  \n",
       "1586606            5.0                4.0       5.2    blitheringidiot  \n",
       "1586607            5.0                4.5       5.2             PopeDX  \n",
       "1586608            3.5                4.0       5.2    treehugger02010  \n",
       "1586609            4.0                3.5       5.2         maddogruss  \n",
       "1586610            2.0                2.5       5.2          yelterdow  \n",
       "1586611            3.5                3.0       5.2           TongoRad  \n",
       "1586612            4.5                4.5       5.2           dherling  \n",
       "1586613            4.5                4.5       5.2               cbl2  \n",
       "\n",
       "[1518478 rows x 8 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "beer_ratings = beer_data.dropna(how='any').loc[:,[\"beer_beerid\",\"review_overall\",\n",
    "                                                  \"review_taste\",\"review_aroma\",\n",
    "                                                 \"review_palate\",\"review_appearance\",\n",
    "                                                 \"beer_abv\", \"review_profilename\"]]\n",
    "print (len(beer_ratings.groupby([\"review_profilename\"]).groups.keys()))\n",
    "print (len(beer_ratings.groupby([\"beer_beerid\"]).groups.keys()))\n",
    "beer_ratings"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python [default]",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
